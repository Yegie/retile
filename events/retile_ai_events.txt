#########################################
#
# Retile AI Events
# Author: Gebnar
#
#########################################

namespace = retile_ai

# Initialize galaxy with rural district counts
event = {
	id = retile_ai.1
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		always = no
		always = yes
	}

	immediate = {
		every_planet = {
			limit = { habitable_planet = yes }
			retile_count_districts_generator = yes
			retile_count_districts_mining = yes
			retile_count_districts_farming = yes
		}
	}
}

# count districts on a planet when blockers are cleared
planet_event = {
	id = retile_ai.2
	hide_window = yes
	is_triggered_only = yes

	trigger = {
		always = no
		always = yes
	}

	immediate = {
		retile_count_districts_generator = yes
		retile_count_districts_mining = yes
		retile_count_districts_farming = yes
	}
}


# Flag AI planets for food focus
country_event = {
	id = retile_ai.51
	hide_window = yes

	trigger = {
		always = no
		is_ai = yes
		is_country_type = default
	}
	
	mean_time_to_happen = {
		months = 12
	}

	after = {
		retile_flag_ai_food_world = yes
	}
}

# Flag AI planets for energy focus
country_event = {
	id = retile_ai.52
	hide_window = yes

	trigger = {
		always = no
		is_ai = yes
		is_country_type = default
	}
	
	mean_time_to_happen = {
		months = 12
	}

	after = {
		retile_flag_ai_energy_world = yes
	}
}

# Flag AI planets for minerals focus
country_event = {
	id = retile_ai.53
	hide_window = yes

	trigger = {
		always = no
		is_ai = yes
		is_country_type = default
	}
	
	mean_time_to_happen = {
		months = 12
	}

	after = {
		retile_flag_ai_minerals_world = yes
	}
}

# Flag AI planets for arcology focus
country_event = {
	id = retile_ai.54
	hide_window = yes

	trigger = {
		always = no
		is_ai = yes
		is_country_type = default
	}
	
	mean_time_to_happen = {
		months = 12
	}

	after = {
		retile_flag_ai_arcology_world = yes
	}
}

# Flag AI planets for city focus
country_event = {
	id = retile_ai.55
	hide_window = yes

	trigger = {
		always = no
		is_ai = yes
		is_country_type = default
	}
	
	mean_time_to_happen = {
		months = 36
	}

	after = {
		retile_flag_ai_city_world = yes
	}
}

# Check AI planets and remove wasteful district deposits
planet_event = {
	id = retile_ai.101
	hide_window = yes

	pre_triggers = {
		has_owner = yes
	}
	
	trigger = {
		always = no
		owner = {
			is_ai = yes
			is_country_type = default
		}
	}
	
	mean_time_to_happen = {
		days = 540
	}

	after = {
		if = {
			limit = {
				num_districts = { type = district_enforcers value > 0 }
				planet_crime < 1
			}
			remove_district = district_enforcers
		}
		if = {
			limit = {
				num_districts = { type = district_soldiers value > 0 }
				owner = { AND = {
					used_naval_capacity_percent < 0.5
					OR = {
						has_monthly_income = { resource = alloys value < 25 }
						has_monthly_income = { resource = consumer_goods value < 0 }
						has_monthly_income = { resource = food value < 0 }
						has_monthly_income = { resource = minerals value < 25 }
						has_monthly_income = { resource = energy value < 25 }
					}
				} }
			}
			remove_district = district_soldiers
		}
		if = {
			limit = {
				num_districts = { type = district_custodians value > 0 }
				free_amenities < -50
			}
			remove_district = district_custodians
		}
		if = {
			limit = {
				free_housing > 5
				num_districts = { type = district_housing value > 0 }
			}
			remove_district = district_housing
		}
	}
}

# Check AI countries and count up admin cap
country_event = {
	id = retile_ai.500
	hide_window = yes

	trigger = {
		always = no
		#is_ai = yes
		is_country_type = default
	}
	
	mean_time_to_happen = {
		days = 90
	}

	after = {
		#retile_count_admin_cap = yes
	}
}
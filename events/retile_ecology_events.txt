namespace = ecology

# Pollution Generation
planet_event = {
	id = ecology.1
	hide_window = yes
	
	trigger = {
		exists = owner
		num_pops > 0
	}
	
	immediate = {
		if = {
			limit = { check_variable = { which = pollution value > 2000 } }
			set_variable = { which = pollution value = 2000 }
		} else_if = {
			limit = { check_variable = { which = pollution value < 0 } }
			set_variable = { which = pollution value = 0 }
		}
	}
	
	mean_time_to_happen = {
		days = 360
	}
	
	after = {
		# Pollution Buildup
		if = { 
			limit = { free_amenities >= 1800 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 12 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = 8 }
			} else = {
				change_variable = { which = pollution value = 10 }
			}
		}
		else_if = { 
			limit = { free_amenities >= 1600 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 11 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = 7 }
			} else = {
				change_variable = { which = pollution value = 8 }
			}
		}
		else_if = { 
			limit = { free_amenities >= 1400 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 10 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = 6 }
			} else = {
				change_variable = { which = pollution value = 8 }
			}
		}
		else_if = { 
			limit = { free_amenities >= 1200 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 9 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = 5 }
			} else = {
				change_variable = { which = pollution value = 7 }
			}
		}
		else_if = { 
			limit = { free_amenities >= 1000 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 8 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = 4 }
			} else = {
				change_variable = { which = pollution value = 6 }
			}
		}
		else_if = { 
			limit = { free_amenities >= 800 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 7 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = 3 }
			} else = {
				change_variable = { which = pollution value = 5 }
			}
		}
		else_if = { 
			limit = { free_amenities >= 600 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 6 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = 2 }
			} else = {
				change_variable = { which = pollution value = 4 }
			}
		}
		else_if = { 
			limit = { free_amenities >= 400 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 5 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = 1 }
			} else = {
				change_variable = { which = pollution value = 3 }
			}
		}
		else_if = { 
			limit = { free_amenities >= 200 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 4 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = 0 }
			} else = {
				change_variable = { which = pollution value = 2 }
			}
		}
		else_if = {
			limit = { free_amenities >= 0 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 2 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = -1 }
			} else = {
				change_variable = { which = pollution value = 1 }
			}
		}
		else_if = {
			limit = { free_amenities > -100 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 2 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = -2 }
			} else = {
				change_variable = { which = pollution value = 0 }
			}
		} else_if = {
			limit = { free_amenities <= -100 }
			if = {
				limit = { owner = { has_policy_flag = environmental_deregulation } }
				change_variable = { which = pollution value = 1 }
			} else_if = {
				limit = { owner = { has_policy_flag = environmental_protection } }
				change_variable = { which = pollution value = -3 }
			} else = {
				change_variable = { which = pollution value = -1 }
			}
		}
		
		
		# Pollution Events
		random_list = {
				50 = { }
				# Drought
				2 = { planet_event = { id = ecology.2 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 50 } }
						planet_event = { id = ecology.2 }
					}
				}
				# Flood
				2 = { planet_event = { id = ecology.3 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 50 } }
						planet_event = { id = ecology.3 }
					}
				}
				# Heat Wave
				2 = { planet_event = { id = ecology.4 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 50 } }
						planet_event = { id = ecology.4 }
					}
				}
				# Cold Wave
				2 = { planet_event = { id = ecology.5 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 50 } }
						planet_event = { id = ecology.5 }
					}
				}
				# Storm
				2 = { planet_event = { id = ecology.6 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 100 } }
						planet_event = { id = ecology.6 }
					}
				}
				# Desertification
				2 = { planet_event = { id = ecology.7 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 200 } }
						planet_event = { id = ecology.7 }
					}
				}
				# Outbreak
				2 = { planet_event = { id = ecology.8 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 200 } }
						planet_event = { id = ecology.8 }
					}
				}
				# Mass Extinction
				2 = { planet_event = { id = ecology.9 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 500 } }
						planet_event = { id = ecology.9 }
					}
				}
				# Climate Change
				2 = { planet_event = { id = ecology.10 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 500 } }
						planet_event = { id = ecology.10 }
					}
				}
				# Tidal Wave
				2 = { planet_event = { id = ecology.11 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 500 } }
						planet_event = { id = ecology.11 }
					}
				}
				# Firestorm
				2 = { planet_event = { id = ecology.12 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 500 } }
						planet_event = { id = ecology.12 }
					}
				}
				# Environmental Collapse
				2 = { planet_event = { id = ecology.13 } }
				2 = { 
					if = {
						limit = { check_variable = { which = pollution value >= 1000 } }
						planet_event = { id = ecology.13 }
					}
				}
				# Death of a World
				2 = { planet_event = { id = ecology.14 } }
			}
	}
}

# Drought
planet_event = {
	id = ecology.2
	title = ecology.2.name
	desc = ecology.2.desc
	picture = GFX_evt_alien_wildlife
	show_sound = event_ghost_town
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_city
			is_planet_class = pc_relic
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			has_modifier = drought
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 25 }
		}
		free_amenities >= 200
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 360 } }
		change_variable = { which = pollution value = -10 }
	}
	
	option = {
		name = ecology.2.a
		add_planet_devastation = 5
		add_modifier = { modifier = drought days = 360 }
	}
	
	option = {
		name = ecology.2.b
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 500 } }
		}
		owner = { add_resource = { energy = -500 } }
		add_planet_devastation = 5
		add_modifier = { modifier = drought days = 180 }
		hidden_effect = { change_variable = { which = pollution value = -5 } }
	}
	
	option = {
		name = ecology.2.c
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		owner = { add_resource = { energy = -1000 } }
		hidden_effect = { change_variable = { which = pollution value = -5 } }
	}
	
	option = {
		name = ecology.2.d
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 25 } }
			solar_system.starbase = { has_starbase_building = deep_space_black_site }
		}
		owner = { add_resource = { influence = -25 } }
		add_planet_devastation = 5
		add_modifier = { modifier = drought days = 360 }
		add_modifier = { modifier = black_propaganda days = 360 }
	}
}

# Flood
planet_event = {
	id = ecology.3
	title = ecology.3.name
	desc = ecology.3.desc
	picture = GFX_evt_underwater_ruins
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_city
			is_planet_class = pc_relic
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			has_modifier = flood
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 25 }
			is_dry = yes
		}
		free_amenities >= 200
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 360 } }
		change_variable = { which = pollution value = -10 }
	}
	
	option = {
		name = ecology.3.a
		add_planet_devastation = 5
		add_modifier = { modifier = flood days = 360 }
		hidden_effect = { validate_planet_buildings_and_districts = yes }
	}
	
	option = {
		name = ecology.3.b
		allow = {
			owner = { resource_stockpile_compare = { resource = consumer_goods value >= 100 } }
		}
		owner = { add_resource = { consumer_goods = -100 } }
		add_planet_devastation = 5
		add_modifier = { modifier = flood days = 180 }
	}
	
	option = {
		name = ecology.3.c
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		owner = { add_resource = { energy = -1000 } }
	}
	
	option = {
		name = ecology.3.d
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 25 } }
			solar_system.starbase = { has_starbase_building = deep_space_black_site }
		}
		owner = { add_resource = { influence = -25 } }
		add_planet_devastation = 5
		add_modifier = { modifier = flood days = 360 }
		add_modifier = { modifier = black_propaganda days = 360 }
	}
}

# Heat Wave
planet_event = {
	id = ecology.4
	title = ecology.4.name
	desc = ecology.4.desc
	picture = GFX_evt_landing_ship
	show_sound = event_ghost_town
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			has_modifier = heat_wave
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 25 }
			is_cold = yes
		}
		free_amenities >= 400
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		change_variable = { which = pollution value = -25 }
	}
	
	option = {
		name = ecology.4.a
		add_planet_devastation = 5
		add_modifier = { modifier = heat_wave days = 360 }
	}
	
	option = {
		name = ecology.4.b
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 500 } }
		}
		owner = { add_resource = { energy = -500 } }
		add_planet_devastation = 5
		add_modifier = { modifier = heat_wave days = 180 }
	}
	
	option = {
		name = ecology.4.c
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		owner = { add_resource = { energy = -1000 } }
	}
	
	option = {
		name = ecology.4.d
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 25 } }
			solar_system.starbase = { has_starbase_building = deep_space_black_site }
		}
		add_planet_devastation = 5
		add_modifier = { modifier = heat_wave days = 360 }
		add_modifier = { modifier = black_propaganda days = 360 }
	}
}

# Cold Wave
planet_event = {
	id = ecology.5
	title = ecology.5.name
	desc = ecology.5.desc
	picture = GFX_evt_outpost
	show_sound = event_crystal_ship
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			has_modifier = cold_wave
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 25 }
		}
		is_cold = yes
		free_amenities >= 400
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		change_variable = { which = pollution value = -50 }
	}
	
	option = {
		name = ecology.5.a
		add_planet_devastation = 5
		add_modifier = { modifier = cold_wave days = 360 }
	}
	
	option = {
		name = ecology.5.b
		allow = {
			owner = { resource_stockpile_compare = { resource = consumer_goods value >= 100 } }
		}
		owner = { add_resource = { consumer_goods = -100 } }
		add_planet_devastation = 5
		add_modifier = { modifier = cold_wave days = 180 }
		hidden_effect = { change_variable = { which = pollution value = -25 } }
	}
	
	option = {
		name = ecology.5.c
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		owner = { add_resource = { energy = -1000 } }
		hidden_effect = { change_variable = { which = pollution value = -25 } }
	}
	
	option = {
		name = ecology.5.d
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 25 } }
			solar_system.starbase = { has_starbase_building = deep_space_black_site }
		}
		owner = { add_resource = { influence = -25 } }
		add_planet_devastation = 5
		add_modifier = { modifier = cold_wave days = 360 }
		add_modifier = { modifier = black_propaganda days = 360 }
	}
}

# Storm
planet_event = {
	id = ecology.6
	title = ecology.6.name
	desc = ecology.6.desc
	picture = GFX_evt_city_ruins
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			has_modifier = storm
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 50 }
		}
		has_building = yes
		free_amenities >= 600
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		change_variable = { which = pollution value = -50 }
	}
	
	option = {
		name = ecology.6.a
		add_planet_devastation = 10
		add_modifier = { modifier = storm days = 360 }
	}
	
	option = {
		name = ecology.6.b
		allow = {
			owner = { resource_stockpile_compare = { resource = consumer_goods value >= 100 } }
		}
		add_planet_devastation = 5
		add_modifier = { modifier = storm days = 180 }
		owner = { add_resource = { consumer_goods = -100 } }
		hidden_effect = { change_variable = { which = pollution value = -50 } }
	}
	
	option = {
		name = ecology.6.c
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		add_planet_devastation = 5
		add_modifier = { modifier = storm days = 90 }
		owner = { add_resource = { energy = -1000 } }
		hidden_effect = { change_variable = { which = pollution value = -50 } }
	}
	
	option = {
		name = ecology.6.d
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 25 } }
			solar_system.starbase = { has_starbase_building = deep_space_black_site }
		}
		owner = { add_resource = { influence = -25 } }
		add_planet_devastation = 10
		add_modifier = { modifier = storm days = 360 }
		add_modifier = { modifier = black_propaganda days = 360 }
	}
}

# Desertification
planet_event = {
	id = ecology.7
	title = ecology.7.name
	desc = ecology.7.desc
	picture = GFX_evt_drilling_for_gas
	show_sound = event_ghost_town
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			owner = { has_country_flag = recent_ecology_event }
			has_planet_flag = desertification_event
			check_variable = { which = pollution value < 100 }
		}
		free_amenities >= 600
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		set_planet_flag = desertification_event
		change_variable = { which = pollution value = -100 }
	}
	
	option = {
		name = ecology.7.a
		if = {
			limit = { has_deposit = d_fungal_forest }
			remove_deposit = d_fungal_forest
			add_deposit = d_frozen_gas_lake
			add_deposit = d_forgiving_tundra
		} else_if = {
			limit = { has_deposit = d_tropical_island }
			remove_deposit = d_tropical_island
			add_deposit = d_rushing_waterfalls
			add_deposit = d_bountiful_plains
		} else_if = {
			limit = { has_deposit = d_marvelous_oasis }
			remove_deposit = d_marvelous_oasis
			add_deposit = d_searing_desert
			add_deposit = d_bountiful_plains
		} else_if = {
			limit = { has_deposit = d_teeming_reef }
			remove_deposit = d_teeming_reef
			add_deposit = d_rushing_waterfalls
			add_deposit = d_boggy_fens
		} else_if = {
			limit = { has_deposit = d_black_soil }
			remove_deposit = d_black_soil
			add_deposit = d_searing_desert
			add_deposit = d_bountiful_plains
		} else_if = {
			limit = { has_deposit = d_great_river }
			remove_deposit = d_great_river
			add_deposit = d_rushing_waterfalls
		} else_if = {
			limit = { has_deposit = d_fertile_lands }
			remove_deposit = d_fertile_lands
			add_deposit = d_searing_desert
		} else_if = {
			limit = { has_deposit = d_lush_jungle }
			remove_deposit = d_lush_jungle
			add_deposit = d_searing_desert
		} else_if = {
			limit = { has_deposit = d_fungal_caves }
			remove_deposit = d_fungal_caves
			add_deposit = d_frozen_gas_lake
		} else = {
			add_modifier = { modifier = drought days = 360 }
			add_modifier = { modifier = heat_wave days = 360 }
			add_deposit = d_destroyed_habitat
		}
	}
	
	option = {
		name = ecology.7.b
		allow = {
			owner = { resource_stockpile_compare = { resource = consumer_goods value >= 100 } }
		}
		if = {
			limit = { has_deposit = d_fungal_forest }
			remove_deposit = d_fungal_forest
			add_deposit = d_fungal_caves
			add_deposit = d_hot_springs
		} else_if = {
			limit = { has_deposit = d_tropical_island }
			remove_deposit = d_tropical_island
			add_deposit = d_great_river
			add_deposit = d_hot_springs
		} else_if = {
			limit = { has_deposit = d_marvelous_oasis }
			remove_deposit = d_marvelous_oasis
			add_deposit = d_lush_jungle
			add_deposit = d_arid_highlands
		} else_if = {
			limit = { has_deposit = d_teeming_reef }
			remove_deposit = d_teeming_reef
			add_deposit = d_great_river
			add_deposit = d_hot_springs
		} else_if = {
			limit = { has_deposit = d_black_soil }
			remove_deposit = d_black_soil
			add_deposit = d_fertile_lands
			add_deposit = d_arid_highlands
		} else = {
			random_list = {
				1 = { add_modifier = { modifier = drought days = 360 } }
				1 = { add_modifier = { modifier = heat_wave days = 360 } }
			}
			add_deposit = d_destroyed_habitat
		}
		owner = { add_resource = { consumer_goods = -100 } }
		hidden_effect = { change_variable = { which = pollution value = -50 } }
	}
	
	option = {
		name = ecology.7.c
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		owner = { add_resource = { energy = -1000 } }
		hidden_effect = { change_variable = { which = pollution value = -50 } }
	}
}

# Outbreak
planet_event = {
	id = ecology.8
	title = ecology.8.name
	desc = ecology.8.desc
	picture = GFX_evt_emergency_workers
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = {
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 100 }
		}
		free_amenities >= 600
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		change_variable = { which = pollution value = -100 }
	}
	
	option = {
		name = ecology.8.a
		add_modifier = { modifier = outbreak days = 360 }
		random_list = {
			1 = { random_owned_pop = { kill_pop = yes } }
			1 = {  }
		}
	}
	
	option = {
		name = ecology.8.b
		allow = {
			owner = { resource_stockpile_compare = { resource = consumer_goods value >= 250 } }
		}
		add_modifier = { modifier = outbreak days = 180 }
		random_list = {
			1 = { random_owned_pop = { kill_pop = yes } }
			3 = {  }
		}
		owner = { add_resource = { consumer_goods = -250 } }
		hidden_effect = { change_variable = { which = pollution value = -50 } }
	}
	
	option = {
		name = ecology.8.c
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 25 } }
			solar_system.starbase = { has_starbase_building = deep_space_black_site }
		}
		owner = { add_resource = { influence = -25 } }
		add_modifier = { modifier = outbreak days = 360 }
		random_list = {
			1 = { random_owned_pop = { kill_pop = yes } }
			1 = {  }
		}
		add_modifier = { modifier = black_propaganda days = 360 }
	}
}

# Mass Extinction
planet_event = {
	id = ecology.9
	title = ecology.9.name
	
	desc = {
		trigger = { 
			NOR = { 
				has_modifier = invasive_species
				has_modifier = introduced_species
				has_modifier = bioscarce
			}
		}
		text = ecology.9.desc
	}
	
	desc = {
		trigger = { 
			NOR = { 
				has_modifier = invasive_species
				has_modifier = introduced_species
			}
			has_modifier = bioscarce
		}
		text = ecology.9.desc.bioscarce
	}
	
	desc = {
		trigger = { has_modifier = invasive_species } 
		text = ecology.9.desc.invasive
	}
	
	desc = {
		trigger = { has_modifier = introduced_species } 
		text = ecology.9.desc.introduced
	}
	
	picture = GFX_evt_animal_wildlife
	show_sound = event_alien_nature
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 250 }
		}
		free_amenities >= 800
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		change_variable = { which = pollution value = -250 }
	}
	
	option = {
		name = ecology.9.a
		if = {
			limit = { has_modifier = introduced_species }
			remove_modifier = introduced_species
		} else_if = {
			limit = { has_modifier = biodiverse }
			remove_modifier = biodiverse
		} else_if = {
			limit = { NOT = { has_modifier = bioscarce } }
			add_modifier = { modifier = bioscarce days = -1 }
		} else_if = {
			limit = { has_modifier = bioscarce }
			add_deposit = d_mass_extinction
		}
	}
	
	option = {
		name = ecology.9.b
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 1000 } }
		}
		if = {
			limit = { has_modifier = introduced_species }
			remove_modifier = introduced_species
			random_list = {
				3 = { add_modifier = { modifier = introduced_species days = -1 } }
				1 = { add_modifier = { modifier = invasive_species days = -1 } }
			}
		} else_if = {
			limit = { NOT = { has_modifier = invasive_species } }
			random_list = {
				1 = { add_modifier = { modifier = introduced_species days = -1 } }
				1 = { add_modifier = { modifier = invasive_species days = -1 } }
			}
		} else_if = {
			limit = { has_modifier = invasive_species }
			remove_modifier = invasive_species
			random_list = {
				1 = { add_modifier = { modifier = introduced_species days = -1 } }
				3 = { add_modifier = { modifier = invasive_species days = -1 } }
			}
		}
		owner = { add_resource = { energy = -1000 } }
		hidden_effect = { change_variable = { which = pollution value = -125 } }
	}
	
	option = {
		name = ecology.9.c
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 2000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		# prevent the change
		owner = { add_resource = { energy = -2000 } }
		hidden_effect = { change_variable = { which = pollution value = -125 } }
	}
}

# Climate Change
planet_event = {
	id = ecology.10
	title = ecology.10.name
		
	desc = {
		trigger = { NOT = { has_modifier = greenhouse_effect } }
		text = ecology.10.desc
	}
	
	desc = {
		trigger = { has_modifier = greenhouse_effect }
		text = ecology.10.desc.greenhouse
	}
	
	picture = GFX_evt_colony_settlement
	show_sound = event_cityscape
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 250 }
		}
		free_amenities >= 800
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		change_variable = { which = pollution value = -250 }
	}
	
	option = {
		name = ecology.10.a
		trigger = { NOT = { has_modifier = greenhouse_effect } }
		if = {
			limit = { has_modifier = calm_weather }
			remove_modifier = calm_weather
		} else_if = {
			limit = { NOT = { has_modifier = hazardous_weather } }
			add_modifier = { modifier = hazardous_weather days = -1 }
		} else_if = {
			limit = { has_modifier = hazardous_weather }
			add_modifier = { modifier = greenhouse_effect days = -1 }
		}
	}
	
	option = {
		name = ecology.10.a2
		trigger = { has_modifier = greenhouse_effect }
		add_deposit = d_destroyed_habitat
	}
	
	option = {
		name = ecology.10.b
		trigger = { NOT = { has_modifier = greenhouse_effect } }
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 25 } }
		}
		add_modifier = { modifier = environmental_awareness days = 360 }
		if = {
			limit = { has_modifier = calm_weather }
			remove_modifier = calm_weather
		} else_if = {
			limit = { NOT = { has_modifier = hazardous_weather } }
			add_modifier = { modifier = hazardous_weather days = -1 }
		} else_if = {
			limit = { has_modifier = hazardous_weather }
			add_modifier = { modifier = greenhouse_effect days = -1 }
		}
		owner = { add_resource = { influence = -25 } }
	}
	
	option = {
		name = ecology.10.c
		trigger = { NOT = { has_modifier = greenhouse_effect } }
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 2000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		owner = { add_resource = { energy = -2000 } }
		hidden_effect = { change_variable = { which = pollution value = -125 } }
	}
	
	option = {
		name = ecology.10.d
		trigger = { has_modifier = greenhouse_effect }
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 2000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		if = {
			limit = { has_modifier = greenhouse_effect }
			remove_modifier = greenhouse_effect
		}
		owner = { add_resource = { energy = -2000 } }
		hidden_effect = { change_variable = { which = pollution value = -125 } }
	}
}

# Tidal Waves
planet_event = {
	id = ecology.11
	title = ecology.11.name
	desc = ecology.11.desc
	picture = GFX_evt_satellite_in_orbit
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 250 }
			is_dry = yes
		}
		free_amenities >= 1000
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		change_variable = { which = pollution value = -250 }
	}
	
	option = {
		name = ecology.11.a
		add_planet_devastation = 20
		add_modifier = { modifier = tidal_wave days = 360 }
		random_owned_pop = { kill_pop = yes }
		hidden_effect = { validate_planet_buildings_and_districts = yes }
	}
	
	option = {
		name = ecology.11.b
		allow = {
			owner = { resource_stockpile_compare = { resource = consumer_goods value >= 250 } }
		}
		add_planet_devastation = 10
		add_modifier = { modifier = tidal_wave days = 180 }
		random_list = {
			1 = { random_owned_pop = { kill_pop = yes } }
			1 = { }
		}
		owner = { add_resource = { consumer_goods = -250 } }
		hidden_effect = { change_variable = { which = pollution value = -250 } }
	}
	
	option = {
		name = ecology.11.c
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 2000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		add_planet_devastation = 10
		add_modifier = { modifier = tidal_wave days = 90 }
		owner = { add_resource = { energy = -2000 } }
		hidden_effect = { change_variable = { which = pollution value = -250 } }
	}
	
	option = {
		name = ecology.11.d
		trigger = { owner = { NOT = { has_modifier = black_propaganda_empire } } }
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 50 } }
			solar_system.starbase = { has_starbase_building = deep_space_black_site }
		}
		owner = { add_resource = { influence = -50 } }
		add_planet_devastation = 20
		add_modifier = { modifier = tidal_wave days = 360 }
		random_owned_pop = { kill_pop = yes }
		owner = { add_modifier = { modifier = black_propaganda_empire days = 360 } }
	}
}

# Firestorm
planet_event = {
	id = ecology.12
	title = ecology.12.name
	desc = ecology.12.desc
	picture = GFX_evt_burning_settlement
	show_sound = event_air_raid_siren
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 250 }
		}
		is_dry = yes
		free_amenities >= 1000
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		change_variable = { which = pollution value = -250 }
	}
	
	option = {
		name = ecology.12.a
		add_planet_devastation = 20
		add_modifier = { modifier = firestorm days = 360 }
		random_owned_pop = { kill_pop = yes }
		hidden_effect = { validate_planet_buildings_and_districts = yes }
	}
	
	option = {
		name = ecology.12.b
		allow = {
			owner = { resource_stockpile_compare = { resource = consumer_goods value >= 250 } }
		}
		add_planet_devastation = 10
		add_modifier = { modifier = firestorm days = 180 }
		random_list = {
			1 = { random_owned_pop = { kill_pop = yes } }
			1 = { }
		}
		owner = { add_resource = { consumer_goods = -250 } }
		hidden_effect = { change_variable = { which = pollution value = -250 } }
	}
	
	option = {
		name = ecology.12.c
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 2000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		add_planet_devastation = 10
		add_modifier = { modifier = firestorm days = 90 }
		owner = { add_resource = { energy = -2000 } }
		hidden_effect = { change_variable = { which = pollution value = -250 } }
	}
	
	option = {
		name = ecology.12.d
		trigger = { owner = { NOT = { has_modifier = black_propaganda_empire } } }
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 50 } }
			solar_system.starbase = { has_starbase_building = deep_space_black_site }
		}
		owner = { add_resource = { influence = -50 } }
		add_planet_devastation = 20
		add_modifier = { modifier = firestorm days = 360 }
		random_owned_pop = { kill_pop = yes }
		owner = { add_modifier = { modifier = black_propaganda_empire days = 360 } }
	}
}

# Environmental Collapse
planet_event = {
	id = ecology.13
	title = ecology.13.name
	
	desc = {
		trigger = { NOT = { has_modifier = bioscarce } }
		text = ecology.13.desc
	}
	
	desc = {
		trigger = { has_modifier = bioscarce }
		text = ecology.13.desc.collapse
	}
	
	picture = GFX_evt_alien_wildlife
	show_sound = event_yellow_alert
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			owner = { has_country_flag = recent_ecology_event }
			check_variable = { which = pollution value < 500 }
			has_modifier = environmental_collapse
		}
		has_modifier = greenhouse_effect
		free_amenities >= 1000
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		change_variable = { which = pollution value = -500 }
	}
	
	option = {
		name = ecology.13.a
		if = {
			limit = { has_modifier = biodiverse }
			remove_modifier = biodiverse
		} else_if = {
			limit = { NOT = { has_modifier = bioscarce } }
			add_modifier = { modifier = bioscarce days = -1 }
		} else_if = {
			limit = { has_modifier = bioscarce }
			add_modifier = { modifier = environmental_collapse days = -1 }
		}
		random_owned_pop = { kill_pop = yes }
	}
	
	option = {
		name = ecology.13.b
		trigger = { owner = { NOT = { has_modifier = bioscarce } } }
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 25 } }
		}
		owner = { add_resource = { influence = -25 } }
		add_modifier = { modifier = environmental_awareness days = 360 }
		if = {
			limit = { has_modifier = biodiverse }
			remove_modifier = biodiverse
		} else_if = {
			limit = { NOT = { has_modifier = bioscarce } }
			add_modifier = { modifier = bioscarce days = -1 }
		} else_if = {
			limit = { has_modifier = bioscarce }
			add_modifier = { modifier = environmental_collapse days = -1 }
		}
		random_owned_pop = { kill_pop = yes }
	}
	
	option = {
		name = ecology.13.c
		trigger = { owner = { NOT = { has_modifier = bioscarce } } }
		allow = {
			owner = { resource_stockpile_compare = { resource = energy value >= 5000 } }
			solar_system.starbase = { has_starbase_building = climate_control }
		}
		if = {
			limit = { has_modifier = biodiverse }
			remove_modifier = biodiverse
		}
		random_list = {
			1 = { random_owned_pop = { kill_pop = yes } }
			1 = { }
		}
		owner = { add_resource = { energy = -5000 } }
		hidden_effect = { change_variable = { which = pollution value = -250 } }
	}
	
	option = {
		name = ecology.13.d
		trigger = { 
			owner = { 
				NOT = { 
					has_modifier = black_propaganda_empire
					has_modifier = bioscarce
				}
			}
		}
		allow = {
			owner = { resource_stockpile_compare = { resource = influence value >= 50 } }
			solar_system.starbase = { has_starbase_building = deep_space_black_site }
		}
		owner = { add_resource = { influence = -50 } }
		owner = { add_modifier = { modifier = black_propaganda_empire days = 360 } }
		if = {
			limit = { has_modifier = biodiverse }
			remove_modifier = biodiverse
		} else_if = {
			limit = { NOT = { has_modifier = bioscarce } }
			add_modifier = { modifier = bioscarce days = -1 }
		} else_if = {
			limit = { has_modifier = bioscarce }
			add_modifier = { modifier = environmental_collapse days = -1 }
		}
		random_owned_pop = { kill_pop = yes }
	}
}

# Death of a World
planet_event = {
	id = ecology.14
	title = ecology.14.name
	
	desc = {
		trigger = { is_dry = yes }
		text = ecology.14.desc.dry
	}
	
	desc = {
		trigger = { is_wet = yes }
		text = ecology.14.desc.wet
	}
	
	desc = {
		trigger = { is_cold = yes }
		text = ecology.14.desc.cold
	}
	
	picture = GFX_evt_ship_in_orbit
	show_sound = event_red_alert
	
	is_triggered_only = yes
	
	trigger = {
		has_owner = yes
		NOT  = { 
			is_planet_class = pc_habitat
			is_planet_class = pc_gas_giant
			is_planet_class = pc_asteroid
			is_planet_class = pc_ice_asteroid
			is_planet_class = pc_rare_crystal_asteroid
			is_planet_class = pc_molten
			is_planet_class = pc_barren
			is_planet_class = pc_barren_cold
			is_planet_class = pc_toxic
			is_planet_class = pc_frozen
			is_planet_class = pc_machine
			is_planet_class = pc_cybrex
			is_planet_class = pc_ringworld_habitable
			owner = { has_country_flag = recent_ecology_event }
		}
		has_modifier = environmental_collapse
	}
	
	immediate = {
		owner = { set_timed_country_flag = { flag = recent_ecology_event days = 1800 } }
		set_variable = { which = pollution value = 0 }
	}
	
	option = {
		name = ecology.14.a
		planet_event = { id = ecology.15 }
		if = {
			limit = { is_dry = yes }
			hidden_effect = {
				add_modifier = { modifier = terraforming_candidate days = -1 }
				remove_modifier = environmental_collapse
				remove_modifier = greenhouse_effect
				remove_modifier = biodiverse
				remove_modifier = bioscarce
				remove_modifier = introduced_species
				remove_modifier = invasive_species
				remove_modifier = "natural_beauty"
				remove_modifier = "atmospheric_aphrodisiac"
				remove_modifier = "atmospheric_hallucinogen"
				remove_modifier = "lush_planet"
				remove_modifier = "bleak_planet"
				remove_modifier = "dangerous_wildlife"
				remove_modifier = "hazardous_weather"
				remove_modifier = "wild_storms"
				if = {
					limit = { num_districts = { type = any value > 0 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 4 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 9 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 14 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 19 } }
					add_deposit = d_city_ruins
				}
				while = {
					limit = { num_pops > 0 }
					random_pop = { pop_event = { id = retile_pop.1001 } }
				}
				destroy_colony = yes
			}
			change_pc = "pc_barren"
		} else_if = {
			limit = { is_wet = yes }
			hidden_effect = {
				add_modifier = { modifier = terraforming_candidate days = -1 }
				remove_modifier = environmental_collapse
				remove_modifier = greenhouse_effect
				remove_modifier = biodiverse
				remove_modifier = bioscarce
				remove_modifier = introduced_species
				remove_modifier = invasive_species
				remove_modifier = "natural_beauty"
				remove_modifier = "atmospheric_aphrodisiac"
				remove_modifier = "atmospheric_hallucinogen"
				remove_modifier = "lush_planet"
				remove_modifier = "bleak_planet"
				remove_modifier = "dangerous_wildlife"
				remove_modifier = "hazardous_weather"
				remove_modifier = "wild_storms"
				if = {
					limit = { num_districts = { type = any value > 0 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 4 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 9 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 14 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 19 } }
					add_deposit = d_city_ruins
				}
				while = {
					limit = { num_pops > 0 }
					random_pop = { pop_event = { id = retile_pop.1001 } }
				}
				destroy_colony = yes
			}
			change_pc = "pc_toxic"
		} else_if = {
			limit = { is_cold = yes }
			hidden_effect = {
				add_modifier = { modifier = terraforming_candidate days = -1 }
				remove_modifier = environmental_collapse
				remove_modifier = greenhouse_effect
				remove_modifier = biodiverse
				remove_modifier = bioscarce
				remove_modifier = introduced_species
				remove_modifier = invasive_species
				remove_modifier = "natural_beauty"
				remove_modifier = "atmospheric_aphrodisiac"
				remove_modifier = "atmospheric_hallucinogen"
				remove_modifier = "lush_planet"
				remove_modifier = "bleak_planet"
				remove_modifier = "dangerous_wildlife"
				remove_modifier = "hazardous_weather"
				remove_modifier = "wild_storms"
				if = {
					limit = { num_districts = { type = any value > 0 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 4 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 9 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 14 } }
					add_deposit = d_city_ruins
				}
				if = {
					limit = { num_districts = { type = any value > 19 } }
					add_deposit = d_city_ruins
				}
				while = {
					limit = { num_pops > 0 }
					random_pop = { pop_event = { id = retile_pop.1001 } }
				}
				destroy_colony = yes
			}
			change_pc = "pc_barren_cold"
		}
	}
		
	option = {
		name = ecology.14.b
		planet_event = { id = ecology.15 }
		random_list = {
			1 = { 
				hidden_effect = {
					add_planet_devastation = 100
					random_owned_pop = { kill_pop = yes }
					remove_modifier = environmental_collapse
					remove_modifier = greenhouse_effect
					remove_modifier = biodiverse
					remove_modifier = bioscarce
					remove_modifier = introduced_species
					remove_modifier = invasive_species
					remove_modifier = "natural_beauty"
					remove_modifier = "atmospheric_aphrodisiac"
					remove_modifier = "atmospheric_hallucinogen"
					remove_modifier = "lush_planet"
					if = {
						limit = { has_modifier = bioscarce }
						remove_modifier = bioscarce
					}
					if = {
						limit = { has_modifier = introduced_species }
						remove_modifier = introduced_species
					}
					if = {
						limit = { has_modifier = invasive_species }
						remove_modifier = invasive_species
					}
					add_modifier = { modifier = irradiated_planet days = -1 }
					add_deposit = d_tomb_world_ruins
					add_deposit = d_tomb_world_wasteland
				}
				change_pc = "pc_nuked"
			}
			3 = { 
				hidden_effect = {
					remove_modifier = environmental_collapse
					remove_modifier = greenhouse_effect
					remove_modifier = biodiverse
					remove_modifier = bioscarce
					remove_modifier = introduced_species
					remove_modifier = invasive_species
					remove_modifier = "natural_beauty"
					remove_modifier = "atmospheric_aphrodisiac"
					remove_modifier = "atmospheric_hallucinogen"
					remove_modifier = "lush_planet"
					remove_modifier = "bleak_planet"
					remove_modifier = "dangerous_wildlife"
					remove_modifier = "hazardous_weather"
					remove_modifier = "wild_storms"
					if = {
						limit = { num_districts = { type = any value > 0 } }
						add_deposit = d_city_ruins
					}
					if = {
						limit = { num_districts = { type = any value > 4 } }
						add_deposit = d_city_ruins
					}
					if = {
						limit = { num_districts = { type = any value > 9 } }
						add_deposit = d_city_ruins
					}
					if = {
						limit = { num_districts = { type = any value > 14 } }
						add_deposit = d_city_ruins
					}
					if = {
						limit = { num_districts = { type = any value > 19 } }
						add_deposit = d_city_ruins
					}
					while = {
						limit = { num_pops > 0 }
						random_pop = { pop_event = { id = retile_pop.1001 } }
					}
					destroy_colony = yes
				}
				change_pc = "pc_molten"
			}
		}
	}
}

# The End
planet_event = {
	id = ecology.15
	title = ecology.15.name
	
	desc = {
		trigger = { is_planet_class = pc_barren }
		text = ecology.15.desc.barren
	}
	
	desc = {
		trigger = { is_planet_class = pc_toxic }
		text = ecology.15.desc.toxic
	}
	
	desc = {
		trigger = { is_planet_class = pc_barren_cold }
		text = ecology.15.desc.cold
	}
	
	desc = {
		trigger = { is_planet_class = pc_molten }
		text = ecology.15.desc.molten
	}
	
	desc = {
		trigger = { is_planet_class = pc_nuked }
		text = ecology.15.desc.tomb
	}
	
	picture = GFX_evt_nuclear_explosion
	show_sound = event_scanner
	
	is_triggered_only = yes
	
	option = {
		name = ecology.15.a
	}
}